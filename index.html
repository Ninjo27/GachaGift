<!-- ƒê·ªÉ tr√°nh v∆∞·ª£t gi·ªõi h·∫°n k√Ω t·ª±, t√¥i s·∫Ω g·ª≠i th√†nh t·ª´ng ph·∫ßn. D∆∞·ªõi ƒë√¢y l√† PH·∫¶N 1 -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Xem Qu·∫£ng C√°o & M·ªü Qu√† Th∆∞·ªüng</title>
  <meta name="google-signin-client_id" content="543690730276-tl87slnraebjhtvrmcumia1e3qj39kd4.apps.googleusercontent.com">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    /* --- gi·ªØ nguy√™n to√†n b·ªô style nh∆∞ file g·ªëc --- */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f4f4f4;
      padding: 50px;
      position: relative;
    }
    input, button {
      font-size: 18px;
      padding: 10px 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    button {
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:disabled {
      background-color: gray;
    }
    #status {
      margin-top: 20px;
      font-size: 18px;
      color: #0033cc;
    }
  </style>
</head>
<body>
  <h1>üéÅ Xem Qu·∫£ng C√°o v√† M·ªü Qu√† Th∆∞·ªüng üéÅ</h1>

  <!-- N√∫t ƒêƒÉng nh·∫≠p Google -->
  <div id="googleLogin" style="margin-bottom: 20px;">
    <div id="g_id_onload"
         data-client_id="YOUR_GOOGLE_CLIENT_ID"
         data-callback="handleGoogleLogin"
         data-auto_prompt="false">
    </div>
    <div class="g_id_signin" data-type="standard"></div>
  </div>

  <!-- Khu v·ª±c nh·∫≠p t√™n -->
  <div id="inputArea" style="display:none;">
    <input type="text" id="playerName" placeholder="T√™n Minecraft c·ªßa b·∫°n">
    <br>
    <button onclick="saveName()">X√°c nh·∫≠n T√™n</button>
  </div>

  <!-- Giao di·ªán ch√≠nh -->
  <div id="gameArea" style="display:none; position: relative;">
    <p><strong>T√™n c·ªßa b·∫°n:</strong> <span id="displayName"></span></p>
    <div id="levelSelection">
      <p>Ch·ªçn M·ª©c ƒê·ªô:</p>
      <label><input type="radio" name="level" value="thuong"> Th∆∞·ªùng (20%)</label><br>
      <label><input type="radio" name="level" value="hien"> Hi·∫øm (10%)</label><br>
      <label><input type="radio" name="level" value="sieuhien"> Si√™u hi·∫øm (5%)</label><br>
      <button onclick="confirmLevel()">X√°c nh·∫≠n M·ª©c ƒë·ªô</button>
    </div>

    <button id="adButton" onclick="watchAd()" style="display:none;">Xem Qu·∫£ng C√°o</button>
    <button id="spinButton" onclick="spinSlot()" style="display:none;">B·∫•m ƒê·ªÉ M·ªü Qu√†</button>

    <div id="giftBox" style="width:200px;height:200px;margin:20px auto;display:none;">
      <div class="lid" style="height:40%;background:orange;"></div>
      <div class="box" style="height:60%;background:yellow;"></div>
    </div>

    <div id="resultIcon"></div>
    <div id="status"></div>
    <div id="coinInfo" style="display:none;">
      <p><strong>S·ªë d∆∞ hi·ªán t·∫°i:</strong> <span id="coinBalance">0</span> ƒë·ªìng</p>
    </div>
  </div>

<script>
let selectedProbability = 0;
let selectedLevelName = "";
let userData = null;

function handleGoogleLogin(response) {
  const data = parseJwt(response.credential);
  userData = {
    name: data.name,
    email: data.email,
    coin: parseInt(localStorage.getItem("userCoin") || "0"),
    role: localStorage.getItem("userRole") || ""
  };
  document.getElementById("googleLogin").style.display = "none";
  if (!userData.role) {
    const role = prompt("B·∫°n l√† viewer (xem qu·∫£ng c√°o) hay publisher (ki·∫øm ti·ªÅn)?", "viewer");
    userData.role = role;
    localStorage.setItem("userRole", role);
  }
  localStorage.setItem("userEmail", userData.email);
  localStorage.setItem("userCoin", userData.coin);
  if (userData.role === "publisher") {
    document.getElementById("coinInfo").style.display = "block";
    document.getElementById("coinBalance").innerText = userData.coin;
  }
  document.getElementById("inputArea").style.display = "block";
}

function parseJwt(token) {
  const base64Url = token.split('.')[1];
  const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));
  return JSON.parse(jsonPayload);
}

function saveName() {
  const name = document.getElementById("playerName").value.trim();
  if (!name) return alert("Nh·∫≠p t√™n Minecraft");
  localStorage.setItem("playerName", name);
  showGameSection();
}

function showGameSection() {
  document.getElementById("inputArea").style.display = "none";
  document.getElementById("gameArea").style.display = "block";
  document.getElementById("displayName").innerText = localStorage.getItem("playerName");
}

function confirmLevel() {
  const radios = document.getElementsByName("level");
  let levelChosen = null;
  for (let i = 0; i < radios.length; i++) {
    if (radios[i].checked) {
      levelChosen = radios[i].value;
      break;
    }
  }
  if (!levelChosen) return alert("Ch·ªçn m·ª©c ƒë·ªô!");
  if (levelChosen === "thuong") selectedProbability = 0.20;
  if (levelChosen === "hien") selectedProbability = 0.10;
  if (levelChosen === "sieuhien") selectedProbability = 0.05;
  selectedLevelName = levelChosen;
  document.getElementById("levelSelection").style.display = "none";
  document.getElementById("adButton").style.display = "inline-block";
}

function watchAd() {
  document.getElementById("status").innerText = "ƒêang xem qu·∫£ng c√°o...";
  document.getElementById("adButton").disabled = true;
  setTimeout(() => {
    document.getElementById("status").innerText = "";
    document.getElementById("adButton").style.display = "none";
    document.getElementById("spinButton").style.display = "inline-block";
  }, 5000);
}

function spinSlot() {
  const win = Ma
